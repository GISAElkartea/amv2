{% extends 'base.html' %}
{% load static i18n compress thumbnail absolute_urls %}

{% block title %}
{% trans 'Archive' %}
{% endblock title %}


{% block extra_js %}
{# Cannot compress this because it includes the JS I18N catalogue #}
{{ tab_media.render_js | join:"" }}
{% compress js %}
<script src="{% static 'js/tabs.js' %}" type="text/javascript" charset="utf-8"></script>
{% endcompress js %}
{% endblock extra_js %}


{% block extra_css %}
{% compress css %}
{{ tab_media.render_css | join:"" }}
{% endcompress css %}
{% endblock extra_css %}


{% block content %}
<ul class="tabs">
  {% for title, reverseurl, form in tabs %}
  <li class="tab{% if request.path == reverseurl %} default{% endif %}"
    data-tab="tab{{ forloop.counter }}">{{ title }} asdsad</li>
  {% endfor %}
</ul>

<ul class="tabsContents">
  {% for title, reverseurl, form in tabs %}
  <li class="tabContent" data-tab="tab{{ forloop.counter }}">
    <form method="get" action="{{ reverseurl }}">
      <ul>
        <li class="mainForm">
          <input id="id_q" name="q" value="{{ request.GET.q }}" placeholder="{% trans 'Search' %}" />
          <button type="submit" value="{% trans 'Search' %}"><i class="fa fa-search"></i></button>
        </li>
        {% if form %}
        {{ form.as_ul }}
        {% endif %}
      </ul>
    </form>
  </li>
  {% endfor %}
</ul>


{% if search_results %}
<ul id="archiveResults">
  {% for result in search_results %}
  <li>
    <article>
      <h1>
        {% if result.url %}
        <a href="{{ result.url }}">{{ result.title }}</a>
        {% else %}
        {{ result }}
        {% endif %}
      </h1>

      {% build_absolute_uri result.meta.image as image_url %}
      {% thumbnail image_url "500" as image %}
      <div class="detail" style="background-image: url('{{ image.url }}');">
      {% empty %}
      <div class="detail">
      {% endthumbnail %}
      </div>

      <div class="text">
        {% if result.description %}
        {{ result.description | truncatewords_html:25 | safe }}
        {% endif %}
      </div>
    </article>
  </li>
  {% endfor %}
</ul>

{% include 'pagination.html' with object_list=search_results %}
{% endif %}

{% if not search_results and request.GET %}
<p id="nothingFound">
  {% blocktrans %}
  Your search didn't yield any results.
  {% endblocktrans %}
</p>
{% endif %}
{% endblock content %}
