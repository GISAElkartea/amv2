{% extends 'base.html' %}
{% load static i18n compress thumbnail absolute_urls %}

{% block title %}
{% trans 'Archive' %}
{% endblock title %}


{% block extra_js %}
{# Cannot compress this because it includes the JS I18N catalogue #}
{{ tab_media.render_js | join:"" }}
{% endblock extra_js %}


{% block extra_css %}
{% compress css %}
{{ tab_media.render_css | join:"" }}
{% endcompress css %}
{% endblock extra_css %}


{% block content %}
<ul class="tabs" id="archive">
  {% for title, reverseurl, form in tabs %}
  <li>
    <input type="radio" name="tabs" id="tab{{ forloop.counter }}" {% if request.path == reverseurl %}checked{% endif %} />
    <label for="tab{{ forloop.counter }}">{{ title }}</label>
    <div id="tab-content{{ forloop.counter }}" class="tab-content">
      <form method="get" action="{{ reverseurl }}">
        <ul>
          <li class="mainForm">
            <input id="id_q" name="q" value="{{ request.GET.q }}" placeholder="{% trans 'Search' %}" />
            <button type="submit" value="{% trans 'Search' %}" ><i class="fa fa-search"></i></button>
          </li>
          {% if form %}
          {{ form.as_ul }}
          {% endif %}
        </ul>
      </form>
    </div>
  </li>
{% endfor %}
</ul>

<ul id="archiveResults">
  {% for result in search_results %}
  <li>
    <article>
      <h1>
        {% if result.url %}
        <a href="{{ result.url }}">{{ result.title }}</a>
        {% else %}
        {{ result }}
        {% endif %}
      </h1>

      {% build_absolute_uri result.meta.image as image_url %}
      {% thumbnail image_url "500" as image %}
      <div class="detail" style="background-image: url('{{ image.url }}');">
      {% empty %}
      <div class="detail">
      {% endthumbnail %}
      </div>

      <div class="text">
        {% if result.description %}
        {{ result.description | truncatewords_html:25 | safe }}
        {% endif %}
      </div>
    </article>
  </li>
  {% endfor %}
</ul>

{% include 'pagination.html' with object_list=search_results %}
{% endblock content %}
